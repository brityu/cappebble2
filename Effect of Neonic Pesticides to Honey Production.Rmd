---
title: "Effect of Neonic Pesticides to Honey Production"
output: html_document
---

INTRODUCTION

In this report, we intend to investigate what factors affect total production of honey across four regions (Midwest, West, Northeast, and South) in the USA. Total production of honey is the average yield per colony multiplied by the number of colonies present in the region. We used the total production of honey as a measurement of bee population in the assumption that higher total honey production corresponds to higher bee population.

At the end of this data analysis, we aim to:
* analyze the relationship between the total production of honey with use of Neonic pesticides in four USA regions;

* compare the effect of different types of neonics, specifically clothianidin, imidacloprid, thiamethoxam, acetamiprid, thaicloprid, to total honey production; and 

* identify the trend of total honey production from 1991 to 2017.

DATA

The dataset was accessed online from URL: https://www.kaggle.com/kevinzmith/honey-with-neonic-pesticide, entitled "Honeybees and Neonic Pesticides". Variables involving honey production is from the US Department of Agriculture (USDA), namely, number of honey-producing colonies, honey yield per colony, total production, stocks, price per lb, and production value. On the other hand, data concenrning use of neonic pesticides from all over US is from the United States Geological Survey (USGS); the variables include total and individual amounts of neonic types 
(clothianidin, imidacloprid, thiamethoxam, acetamiprid, thaicloprid). Neonic data is collected by country, state, region, and year. Kevin Zmith classified the state into four regions: South, West, Midwest, and Northeast using US Census.


```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)

honey.csv <- read.csv("Honey_v03.csv")
glimpse(honey.csv)
```

DATA ANALYSIS:

The outcome variables we used to evaluate the effect of Neonic pesticides to
honey production is the total production (denoted as "totalprod"). The total
production takes into account the number of colonies and the honey yield per
colony in pounds (lb). We first analyzed the relationship of the total production
with the total Neonic ("nAllneonic") pesticides (in kg) per Region through a
scatterplot using the GGplot2 package.




```{r}
honey.csv <- read.csv("Honey_v03.csv")


neonicvtotalprod <- honey.csv %>%
  group_by(Region) 


ggplot(data = neonicvtotalprod, mapping = aes(x = nAllNeonic, y = log(totalprod), group = Region)) +
  facet_grid(.~ Region) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs (x = "Total Neonic (kg)", y = "Total Production (lb)", title = " Bee Honey Production under Neonic Pesticide by Region")
```
The relationship of the total production and total neonic is positive for all
regions except Midwest, as shown in the figure. To identify the strength and
direction of the relationship between the two variables in different regions, 
we used the Spearman method of correlation test. Indeed, out of the four regions,
the correlation of total honey production and neonic pesticides are weakly
correlated towards negative direction and is not statistically significant (rho:
-0.103). South, west, and northeast regions have a weak positive correlation with
correlation coefficient of 0.403, 0.355, and 0.351, respectively. The weak
linear relationship trend in all regions, therefore, indicate that honey
production and use of neonic pesticides do not have a statistically significant
relationship.
```{r}
#Statistical test: correlation per region
neonicstatmw <- honey.csv %>%
  filter(Region == "Midwest")
cortest.mw <- cor.test(neonicstatmw$totalprod, neonicstatmw$nAllNeonic, method = "spearman", exact = FALSE)
cortest.mw


neonicstatwest <- honey.csv %>%
  filter(Region == "West")
cortest.w <- cor.test(neonicstatwest$totalprod, neonicstatwest$nAllNeonic, method = "spearman", exact = FALSE)
cortest.w

neonicstatne <- honey.csv %>%
  filter(Region == "Northeast")
cortest.ne <- cor.test(neonicstatne$totalprod, neonicstatne$nAllNeonic, method = "spearman", exact = FALSE)
cortest.ne

neonicstatsouth <- honey.csv %>%
  filter(Region == "South")
cortest.s <- cor.test(neonicstatsouth$totalprod, neonicstatsouth$nAllNeonic, method = "spearman", exact = FALSE)
cortest.s


#Making a data frame of statistical results
Region <- c("Midwest", "West", "Northeast", "South")
p.value <- c(cortest.mw$p.value, cortest.w$p.value, cortest.mw$p.value, cortest.s$p.value)
rho <- c(-0.1027632, 0.3549792, 0.3510381, 0.4034019)
significance <- c("ns", "*", "*", "*")

allneonic <- cbind(Region, p.value, rho, significance)
allneonic <- data.frame(allneonic); allneonic
```

According to the USGS data, there are fives types of neonics used in the US
States, namely, clothianidin, imidacloprid, thiamethoxam, acetamiprid,
thaicloprid. To know what neonic type significantly contributes to the changes
in the total honey production, we visualized and analyzed their relationship
using the same procedure we used for the first analysis.


```{r}
byneonic <- select(honey.csv, totalprod, 12:16, Region); byneonic
byneonic <- na.omit(byneonic)
byneonicA <- gather(byneonic, "Type", "Amount", 2:6)
byneonicB <- byneonicA %>%
  mutate(logtotalprod = log(totalprod), logamount = log(Amount))
byneonicB

ggplot(byneonicB, aes(x = logamount, y = logtotalprod, color = Type)) + 
  geom_point() + facet_grid(.~ Region) + 
   labs(Title = "Effects of different Neonic types to honey production by Region", x = "Amount of Neonic (kg)", y = "Total Honey Production (lb)") +
   scale_fill_discrete(name = "Type", labels = c("Acetamiprid", "Clothianidin", "Imidacloprid", "Thiacloprid", "Thiamethoxam"))  +
  geom_smooth(method = lm, se = FALSE)

#filter dataset by region
midwest <- byneonic %>%
  filter(Region == "Midwest")

northeast <- byneonic %>%
  filter(Region == "Northeast")

south <- byneonic %>%
  filter(Region == "South")

west <- byneonic %>%
  filter(Region == "West")

#Correlation test per neocin type per region

acemid.cor <- cor.test(midwest$totalprod, midwest$Acetamiprid, method = "spearman", exact = FALSE)
acemid.cor

clomid.cor <- cor.test(midwest$totalprod, midwest$Clothianidin, method = "spearman", exact = FALSE)
clomid.cor


midmid.cor <- cor.test(midwest$totalprod, midwest$Midacloprid, method = "spearman", exact = FALSE)
midmid.cor


thiamethid.cor <- cor.test(midwest$totalprod, midwest$Thiamethoxam, method = "spearman", exact = FALSE)
thiamethid.cor

thiaclomid.cor <- cor.test(midwest$totalprod, midwest$Thiacloprid, method = "spearman", exact = FALSE)
thiaclomid.cor


#northeast

acene.cor <- cor.test(northeast$totalprod, northeast$Acetamiprid, method = "spearman", exact = FALSE)
acene.cor

clone.cor <- cor.test(northeast$totalprod, northeast$Clothianidin, method = "spearman", exact = FALSE)
clone.cor


midne.cor <- cor.test(northeast$totalprod, northeast$Midacloprid, method = "spearman", exact = FALSE)
midne.cor


thiamethne.cor <- cor.test(northeast$totalprod, northeast$Thiamethoxam, method = "spearman", exact = FALSE)
thiamethne.cor


thiaclone.cor <- cor.test(northeast$totalprod, northeast$Thiacloprid, method = "spearman", exact = FALSE)
thiaclone.cor

#south

acesouth.cor <- cor.test(south$totalprod, south$Acetamiprid, method = "spearman", exact = FALSE)
acesouth.cor

closouth.cor <- cor.test(south$totalprod, south$Clothianidin, method = "spearman", exact = FALSE)
closouth.cor


midsouth.cor <- cor.test(south$totalprod, south$Midacloprid, method = "spearman", exact = FALSE)
midsouth.cor


thiamethsouth.cor <- cor.test(south$totalprod, south$Thiamethoxam, method = "spearman", exact = FALSE)
thiamethsouth.cor


thiaclosouth.cor <- cor.test(south$totalprod, south$Thiacloprid, method = "spearman", exact = FALSE)
thiaclosouth.cor

#west

acewest.cor <- cor.test(west$totalprod, west$Acetamiprid, method = "spearman", exact = FALSE)
acewest.cor

clowest.cor <- cor.test(west$totalprod, west$Clothianidin, method = "spearman", exact = FALSE)
clowest.cor


midwest.cor <- cor.test(west$totalprod, west$Midacloprid, method = "spearman", exact = FALSE)
midwest.cor


thiamethwest.cor <- cor.test(west$totalprod, west$Thiamethoxam, method = "spearman", exact = FALSE)
thiamethwest.cor


thiaclowest.cor <- cor.test(west$totalprod, west$Thiacloprid, method = "spearman", exact = FALSE)
thiaclowest.cor

#making dataframe of the significance of statistical results
Region <- c("Midwest", "Midwest", "Midwest", "Midwest", "Midwest", "Northeast", "Northeast", "Northeast", "Northeast","Northeast","South", "South", "South", "South", "South", "West", "West", "West", "West","West")
NeonicType <- c("Acetamiprid", "Clothianidin", "Midacloprid", "Thiamethoxam", "Thiacloprid", "Acetamiprid", "Clothianidin", "Midacloprid", "Thiamethoxam", "Thiacloprid", "Acetamiprid", "Clothianidin", "Midacloprid", "Thiamethoxam", "Thiacloprid", "Acetamiprid", "Clothianidin", "Midacloprid", "Thiamethoxam", "Thiacloprid")
p.value <- c(acemid.cor$p.value, clomid.cor$p.value, midmid.cor$p.value, thiamethid.cor$p.value, thiaclomid.cor$p.value, acene.cor$p.value, clone.cor$p.value, midne.cor$p.value, thiamethne.cor$p.value, thiaclone.cor$p.value, acesouth.cor$p.value, closouth.cor$p.value, midsouth.cor$p.value, thiamethsouth.cor$p.value, thiaclosouth.cor$p.value, acewest.cor$p.value, clowest.cor$p.value, midwest.cor$p.value, thiamethsouth.cor$p.value, thiaclowest.cor$p.value)

rho <- c(-0.3406599, -0.178460 ,-0.04370683 ,-0.1223294 ,-0.2207321  ,0.178998
         ,0.1504854 ,0.2958545 ,0.178656 ,0.2972762, 0.06931884, -0.03242255,
         0.5089368, 0.1946103, -0.2852726, 0.06372726, -0.07198862 , 0.3833301,
         0.1946103, 0.1439576)

1.533013e-08 < 0.05

significance <- c("*", "*", "ns", "*", "*", "ns", "*", "ns", "*", "ns","ns", "*", "*", "*", "ns", "ns", "*", "*", "*")
  
neonic.type.df <- cbind(Region, NeonicType, p.value, rho, significance)
neonic.type.df <- as.data.frame(neonic.type.df)
View((neonic.type.df))

```

 
* outcome and predictor variables we use to answer the question
* comparison groups that we use (if applicable)
* very preliminary exploratory data analysis
--> summary statistics
--> visualizations
--> + explanation on how they help you learn more about your data

* the methods that you believe will be useful in answering your question(s)

* What results from these specific statistical methods are needed to support your hypothesized answer?

* Each section should be no more than 1 page (excluding figures). You can check  a print preview to confirm length
